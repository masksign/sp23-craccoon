"""
q = 2^24 - 2^18 + 1
sqr1 = sqrt(-1) mod q
i2 = 2^(-1) mod q
"""
q = 16515073
sqr1 = 7082569
i2 = 8257537
i2sqr1 = 4716252

"""
Primitive roots of unity
"""
roots_dict = {
    2: [7082569],
    4: [4370030, 7937887],
    8: [6691249, 7865294, 4449468, 14701517],
    16: [5863257, 2419755, 1118374, 1710546, 9031366, 16070404, 15267332, 12679402],
    32: [439657, 539756, 232109, 1126528, 3674520, 5134148, 7993030, 6488980, 795145, 3595641, 7529329, 13400069, 15761721, 5748479, 14204362, 6643521],
    64: [3638055, 8213914, 7197603, 1853964, 3145940, 6648236, 4735139, 4646940, 3696920, 620214, 903902, 4158701, 326592, 7264605, 3193071, 744173, 1056295, 12816999, 1758654, 4640015, 7763718, 757458, 14617423, 6414282, 3319807, 11527085, 6822433, 6889568, 13048896, 3549838, 2821170, 6785074],
    128: [4274999, 247589, 6787297, 2865148, 3130812, 1958444, 1388187, 4711760, 3020673, 3932547, 5386368, 158418, 3704500, 4009089, 7947334, 5676423, 3331329, 7142760, 3850516, 7029828, 433866, 7691064, 7981986, 5519785, 3390830, 2322432, 7126905, 4818839, 6599638, 4905929, 1622153, 2747293, 9718607, 5673273, 11680882, 3485561, 5314359, 9614847, 16246418, 45927, 1956119, 14829405, 14353405, 3538974, 11093399, 14212670, 9682935, 9027186, 1153834, 4892175, 8664126, 10317975, 8667115, 3672253, 249239, 10707833, 15499781, 1835001, 438055, 119369, 3798012, 13725793, 7288691, 9620564],
    256: [5515546, 6589263, 3469273, 7933158, 4840387, 6534124, 1217374, 4412815, 3634740, 2583588, 7438080, 6387041, 6673171, 5186707, 2797579, 4893336, 7562300, 634717, 7557423, 7208986, 5764448, 7077809, 288707, 6514934, 122472, 4788611, 7390554, 2343449, 3789805, 3623897, 3896188, 1386345, 7059669, 3701832, 8166241, 282507, 5894973, 4844787, 7089410, 3369654, 422448, 2151425, 8055128, 6028281, 1131382, 5824169, 6332231, 1377945, 7345213, 2490007, 3537189, 6193152, 1179283, 3683934, 7577453, 6588986, 2231135, 742006, 2532287, 7631529, 3709378, 4770223, 3994431, 1156976, 5621351, 9701480, 13836538, 4943904, 9393060, 12391840, 13630924, 12223605, 3094619, 5584845, 4353429, 1653904, 12994510, 8514856, 13657866, 870912, 9646724, 4689744, 8321811, 1148518, 14495185, 12326898, 5060400, 15925394, 1766910, 14971259, 7523120, 7083482, 9331967, 12867157, 7796277, 14357843, 6210375, 10221175, 8329036, 6716353, 9837630, 4065675, 8509099, 4886067, 13713420, 9068162, 6926697, 8889662, 6161896, 15314090, 6690820, 9001110, 10366684, 6357423, 7876802, 11010046, 15846198, 4649825, 15469093, 9681791, 10062393, 879721, 8027718, 11953617, 14337358, 6286617, 3441479, 1185784],
    512: [4039465, 1964473, 6757622, 1550929, 2004179, 2217795, 6876054, 703209, 6612548, 3615733, 1149361, 471052, 2885906, 3999841, 4022614, 8026825, 6121761, 2671322, 4645755, 7922320, 2341696, 5533080, 7213100, 2457329, 5625408, 7456893, 2293744, 3594477, 6605126, 4265974, 91351, 5260871, 7792783, 4759502, 1013495, 3909789, 1403758, 6827718, 6767182, 3990589, 3610112, 108106, 6496131, 3715058, 5853353, 3828590, 6939759, 3966994, 8231119, 3752996, 1009595, 4907255, 611143, 6046349, 3013398, 5270832, 2287666, 5979667, 820452, 3109227, 7148326, 3431132, 6369696, 608251, 1185401, 710476, 4529339, 740426, 1467731, 7528473, 7544037, 3540628, 8215774, 7427104, 7203045, 4693848, 6334, 6053778, 6694046, 507672, 916816, 336909, 194393, 6259899, 7361798, 4817377, 4671823, 1514695, 648835, 504427, 4760938, 5076899, 1124529, 4869979, 3688796, 343990, 791073, 8015922, 4913535, 4451326, 7309151, 3509326, 3857874, 997858, 329301, 5415063, 2151898, 2082234, 3014692, 4249603, 6052711, 6795977, 3258044, 982608, 6497582, 8147271, 1967965, 5227202, 8155234, 6974930, 6655419, 5700846, 3969609, 581343, 6233101, 7659539, 18206, 4438770, 16146595, 9479303, 7266694, 14822898, 10426104, 2802371, 7186981, 6744367, 10103917, 4704549, 16083675, 1990951, 15707130, 12113276, 5793307, 4121941, 11605467, 11579343, 14327201, 8291272, 16044290, 7127027, 12870412, 8052154, 8035728, 2459521, 9380334, 5896500, 7580989, 2812771, 5575471, 4502965, 14639849, 1821071, 10600953, 16354526, 3999772, 6874238, 5771454, 16276931, 10394818, 16231995, 14324348, 343806, 12128437, 15146979, 6761163, 8569987, 10766446, 8523965, 16149191, 12108645, 4893398, 6929801, 15001088, 13145098, 16324696, 14896572, 4126393, 10116138, 1047853, 2785164, 4765526, 14754880, 9279822, 9664910, 14829287, 8481700, 13516329, 1976562, 6422331, 12183308, 1448146, 9544211, 2388636, 1836290, 7949867, 898424, 177991, 11528430, 5521915, 16143408, 1353792, 12345765, 13822026, 12516928, 10898682, 8795562, 2343955, 9115446, 9941860, 3530555, 1591075, 3560855, 1568374, 3602359, 13102760, 15654919, 2109528, 11654354, 1651846, 2529028, 6227409, 8165979, 322226, 13544203, 11384559, 3897492, 14440168, 878136, 5271654, 10962449, 11058598, 4678353, 10903519, 1594660, 15282362, 1312817, 14964825, 10585624, 5762142, 8080892, 13094789, 5777831, 4693212, 11304090, 3183093, 13894785],
    1024: [848788, 2601139, 6826941, 5040562, 4161017, 4666217, 826877, 3370483, 1305599, 7450255, 6430377, 5016559, 5631039, 5501637, 3774637, 5767170, 996208, 6224365, 3028075, 6248490, 8025813, 4040760, 430637, 3930260, 6728934, 1347282, 6203814, 5540962, 665412, 2596783, 4561042, 987927, 6884707, 1263137, 1870191, 7651759, 6376733, 3060512, 4432814, 4266316, 539136, 1376981, 233923, 179900, 4481179, 5054276, 3457285, 6735036, 6304556, 5926417, 6524840, 3609703, 4794037, 433005, 5262471, 2678971, 6970214, 237436, 6976826, 6563364, 3993583, 6625036, 5335762, 5984087, 348321, 2426982, 4268860, 4543707, 2632616, 1902774, 3649269, 5358450, 4730800, 7930902, 4391870, 4804645, 8132236, 3731793, 7318918, 6816373, 192733, 7927335, 3215937, 2472743, 327095, 4526907, 2364554, 7083576, 3114297, 5676580, 3833856, 4888200, 758644, 2506032, 4774992, 7156654, 7012798, 6092606, 8023291, 3029208, 4696870, 7191955, 109219, 1599364, 7110708, 7491874, 2209998, 5617798, 4526182, 998083, 6809231, 5358117, 3984790, 7936102, 5389093, 6278230, 75816, 967782, 6934401, 7200046, 7527229, 6714196, 6112733, 2258402, 393512, 7827152, 7118076, 5760911, 6656714, 360494, 3218650, 6062532, 987231, 3415228, 6138187, 3432860, 5207948, 4793730, 1384174, 4620524, 1154680, 1774050, 2481817, 3866126, 1445023, 1790622, 7973045, 939762, 1833075, 1437696, 5025291, 6128819, 5015476, 2656341, 366794, 6315813, 7120431, 4987176, 2136659, 7349170, 3765850, 28431, 1428751, 3592752, 1152730, 2634472, 4085294, 1774432, 2935182, 147567, 8161579, 5588258, 5739713, 4887095, 4356659, 4975669, 1844041, 1498969, 1135953, 944350, 632599, 2367442, 2023427, 7657775, 1690103, 2431450, 7768459, 4073678, 3300019, 2022094, 5591021, 6938221, 5893328, 3970746, 2446815, 7546791, 1059770, 8166579, 3862148, 2226761, 6745078, 5796275, 1514938, 8168498, 5773148, 7690746, 6129679, 8077888, 202176, 2580752, 8190074, 1976663, 3360866, 5731898, 6362183, 383942, 6657668, 2466463, 1147692, 4455659, 6894474, 7452511, 517381, 5719476, 6563625, 5839159, 7166946, 8008007, 1802338, 6206629, 1605418, 4633999, 5074064, 1515285, 2225873, 6783689, 373578, 4398521, 6471952, 928856, 8074362, 3781761, 6682752, 7528075, 3479873, 6291457, 4127498, 8210281, 800453, 2374463, 4632771, 4443321, 4624487, 6018979, 7939241, 1088957, 2747810, 10234887, 14965236, 14868635, 1169799, 598571, 2457377, 16155194, 9762141, 9527337, 12240501, 14764058, 431832, 12492754, 14612323, 9051531, 12769769, 4126040, 6909178, 7106800, 15832657, 9827330, 13666065, 2115651, 1758108, 2084423, 7592910, 3439102, 4172897, 15226071, 16311220, 10803595, 2932782, 12507157, 11927460, 696137, 12181253, 5192760, 15725755, 2557777, 4093449, 9600727, 11947717, 12050128, 4927155, 12015360, 7984659, 5562009, 9696749, 4172173, 3811299, 16096004, 16303300, 2045023, 6106873, 15732562, 58109, 11132212, 13201866, 2310822, 5846876, 15270282, 10276229, 7424502, 7753319, 10167066, 4561865, 1854409, 11162976, 11662337, 9539605, 12919580, 9517996, 5647523, 600731, 6561241, 12459670, 13089833, 9488845, 14688869, 13982110, 7329018, 15869966, 4288922, 13823595, 6091513, 9899172, 2794616, 14080854, 9932013, 12703898, 2520618, 14825413, 14369426, 9973222, 7733427, 10382647, 9498234, 13169975, 7758809, 8761821, 10753001, 82561, 5210502, 16092522, 15825103, 6280673, 16206417, 11069547, 3056474, 12515990, 14817744, 7512425, 2867195, 1729554, 9993155, 1583849, 11386585, 15963903, 15235647, 12290340, 13252177, 4529410, 9845290, 5128162, 1608877, 5612928, 10848604, 9855124, 6064958, 5917970, 1344580, 13252863, 7435605, 12432116, 14428898, 10814408, 3628949, 2221535, 635147, 6960036, 14371274, 3903075, 6486594, 12407674, 15585210, 4505760, 16298372, 6721648, 11856964, 11996275, 6544778, 9882719, 1947285, 11281087, 3832774, 5932101, 12730334, 9760505, 13486098, 13675968, 15233646, 8916827, 6974811, 14374244, 1986964, 4612144, 11886757, 9795363, 2665050, 15110584, 1547265, 8701056, 16259167, 1068378, 15244058, 7701522, 16353136, 15185133, 13099836, 6654572, 9665290, 10789886, 2620401, 13869500, 3511354, 5159197, 6483838, 5271636, 6328107, 6631827, 14675153, 12677173, 16399327, 10163464, 4387507, 2086696, 5274946, 15950345, 10958419, 2174830, 10352881, 5350067, 14354296, 8824467, 10086645, 5383180, 13231474, 10915864, 14591890, 11906520, 12179616, 4777351, 1683049, 989186, 3375993, 4189310, 2104848, 13847360, 10463244, 15291487, 3648659, 7820752, 10687776, 1284465, 15971465, 7572710, 10892372, 12782386, 14675963, 11826785, 53437, 14695297, 4186116, 3412694, 10873337, 12032620, 5497749, 7941418, 9100647, 835651, 388810, 9517303, 7623914, 11441073, 7622343, 5788889, 15363521, 11969726, 1047981, 13395609, 3908835, 6877150, 1114523, 14692604, 5737114],
}