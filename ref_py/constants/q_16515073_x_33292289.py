"""
q = (2^25 - 2^18 + 1) * (2^24 - 2^18 + 1)
sqr1 = sqrt(-1) mod q
i2 = 2^(-1) mod q
"""
q = 549824583172097
sqr1 = 10071493140597
i2 = 274912291586049
i2sqr1 = 269876545015750

"""
Primitive roots of unity
"""
roots_dict = {
    2: [10071493140597],
    4: [181563586843173, 526192645311247],
    8: [184720323161863, 177151285498690, 367214974966737, 465021792796973],
    16: [35563476741209, 126366367524648, 174109411504460, 90180116072786, 456499588938802, 219848969398058, 455362114978337, 393589854663973],
    32: [27306553855056, 76242935880243, 151924263967364, 57043796798242, 164564132248641, 42147688179293, 269412251612592, 69864440514868, 315338588412699, 544766737226930, 319392603552132, 338399458584109, 115715217514935, 303109186595295, 265831684340266, 300132058540701],
    64: [125698206108680, 241789388058330, 3432117084342, 32914258828857, 28249181746330, 153924711411759, 60954640340385, 231873019450737, 7300773511030, 118540086189503, 115511186769861, 138398818885156, 273233204157761, 46445682976378, 185854150435781, 272699298430622, 120396669117691, 459448113732586, 260827889147147, 418310442345297, 288689164010186, 372136372265025, 512445988887228, 173755631580247, 324394429367075, 176789143254913, 130412313636641, 84368431742038, 396151997755901, 30365834276907, 153783155769351, 497478379401166],
    128: [73328456690460, 218023380020654, 177502098340777, 115774869223099, 73968691323693, 108946991378221, 146216338617148, 34198999857709, 18138618659258, 50256658061987, 11017248143881, 3290144452204, 46239663401190, 257874759384987, 88850951231248, 160721788601991, 238320014043715, 223200010003760, 89678013283760, 46606139116367, 11826014541820, 88575890949896, 30652301856913, 196320928942994, 197094445572620, 259660372474214, 264925305146614, 247724976250035, 89534191147870, 230417056734713, 253459515899712, 3077654625602, 4718520352996, 177848679069685, 451534158020388, 519895348159670, 190970989920067, 521503583924703, 504246304894023, 147083792983367, 164410038202332, 493151352680350, 449954134476295, 64436103420022, 538231367092704, 327714009467652, 459067535840441, 327236658932321, 494054954185582, 469276292444787, 17488544950799, 271245498047679, 156234014415252, 357627545350227, 490348670797062, 336764532771993, 111502271567297, 491547724637295, 262972518795559, 274937313382714, 168610928164588, 275867608926911, 423789044147894, 13013068331350],
    256: [121239400644760, 261431335965330, 176789025897443, 224332609418504, 205761836134755, 259158911436008, 214893679124242, 162942989146387, 62673065911391, 141032227172142, 108386969394631, 93813267451030, 121176383884305, 248356415304399, 138497832045156, 214776327437843, 90632842675901, 212943951190173, 1637333372935, 123349677612771, 28638291895104, 268074599430676, 62790150026799, 232477824657251, 187490111271807, 216999498219034, 186484365473851, 139357552558885, 219597937632070, 154437653554929, 74750497959907, 152200475126182, 75814792535477, 120738643292023, 249217943698755, 184137446481731, 127075591143761, 119777486577156, 37573488503622, 8455638590440, 248107312718766, 240226871106802, 10299850723024, 111691051774512, 236536760404807, 30754987555724, 159772877868508, 222244517493483, 98289709098410, 98637626511112, 83748607460606, 194448429937730, 18774520121476, 120226337916877, 225511747367519, 146924404755149, 148769735439607, 157457239175210, 168255830548756, 58223563194780, 269581922725544, 175739028910588, 208776266921228, 142189548145195, 296880561078922, 81415752938930, 192728449350160, 315237394597427, 283514220274787, 301628279019615, 260568030033322, 3669556807605, 455904430338946, 387189496352732, 77665837672815, 260815915520474, 110724854094832, 46948496901580, 487152829888253, 292690283277548, 393843490410358, 77451462333597, 339943914050155, 470199802300061, 196603223226735, 160465166126198, 217297250101847, 18624617821937, 9145559852012, 367387779494119, 223710443504271, 442027573994877, 535514948866715, 378988031974409, 285261039901157, 340877986672159, 308267791237871, 94548758127944, 232634531194115, 282684765051020, 154697004734617, 180171163659631, 288386208373916, 449738658933770, 77606859893569, 410479232172473, 505827753601992, 425432149195257, 207299377434154, 276688388661035, 87529065836094, 133928234446866, 301493800997807, 17087422254037, 195321678078742, 73635033445121, 216820511372477, 319885728816456, 331299030848141, 274600950873796, 405152555853741, 277253676426845, 380246332836372, 101014083767513, 328642446342002, 146058872699539, 48981298174549, 233193178447445],
    512: [13293324544894, 48139853088418, 35368268170451, 156405634329493, 80044917986467, 123459384618003, 45526642857684, 26813384614647, 243311368768677, 188889836052687, 173225516755960, 262531445061341, 241193133176800, 114936048797827, 261585865475091, 88827170698522, 27922413263352, 104627132089488, 226656698425835, 216443602294068, 162843260859503, 164770598875963, 109872583039762, 62883860564566, 77247656812796, 252123802060530, 137194217278299, 195301933929799, 200621490197406, 215320410680377, 232714240122624, 123287050382163, 75425267204697, 133108894932196, 2102920445728, 176467744132696, 15296961905205, 92528596902247, 45486573768164, 78250459304282, 234434095499409, 231621642757581, 88608027153630, 28693156692224, 125197440728093, 59010049906589, 64479579590749, 68251034916488, 149717599771527, 212222572601481, 27513732769179, 211485431465999, 1328860817950, 40297652627796, 101987235800745, 143052411184425, 61678364525284, 273669766396294, 199724987932179, 99555467343300, 256676590462699, 168498463168081, 34439829138772, 129594560835408, 221398460266061, 73818979112217, 200176280418075, 236561088129469, 164728615202844, 268657380484422, 255564325040771, 250957684922673, 231010463561739, 57008506239588, 13610161382991, 116249569247986, 55321682677364, 4547128899688, 77617856159453, 174320553152853, 75892369706467, 123983686279675, 213572983156533, 260114369010681, 266925742553263, 162457729041289, 246267034130611, 84037814240427, 14964000626095, 44967352379322, 198684223798652, 122121691375162, 143658987373612, 267385955595376, 87648672027306, 128300041316901, 22134660912324, 145113082531290, 180261637948480, 223331799163117, 153528102356326, 185047535050466, 162177109002037, 33090295045227, 216168550518370, 238624404840883, 200430756721727, 172168060217011, 220278640181101, 32817122112838, 209556930461895, 236565177187383, 194986998535464, 14991295616278, 62237606899882, 129242351135304, 202074200723557, 122634482626777, 189268642854373, 139765397447949, 274139820224606, 183322824040638, 106827925740895, 152328618046783, 79700375812915, 171967666592157, 236553995023384, 183030993740270, 48256896356129, 507542999030511, 483730824784036, 246565670630906, 346798380958211, 405984510008289, 111069840049661, 539569373349275, 371739061346051, 1444160380494, 26172015109079, 204485133836277, 136166316299246, 517535499139117, 189869410815793, 428999002965184, 426621551449096, 511341983477192, 298674669343657, 176059817588582, 260635551319780, 299951163782117, 156237873812285, 242877232976199, 257372049688965, 200539258761499, 96931912342509, 90039987534635, 110095208702123, 180219664802063, 327669816519261, 473099924986527, 164309399215877, 259099359394349, 268440775160239, 300777092585402, 259285237107812, 491289478581773, 131460562290648, 349003197345780, 341628321222390, 453760609263158, 401463847135853, 95478794394129, 445987566106488, 318781855695416, 143526387553173, 298200896681240, 446322673554329, 304297736912243, 168973911505187, 490665785315731, 441797955637462, 466362048377923, 386195993044569, 498446407874574, 128522709608884, 379454168230879, 268410112292095, 488533146723939, 539573229379121, 191441899584214, 413674590872919, 441770253447263, 138185380861762, 164874164181114, 256235115040536, 287099327974140, 237976563360306, 187900535435416, 540838553656969, 179489924103192, 228479773982140, 458285211628850, 256147065710261, 205970691902731, 193127092112335, 21075136507788, 505895810007560, 468623009623030, 190679106657262, 409570211482180, 95189653571602, 308798926099352, 50052132933740, 510208314755317, 221234678933719, 172026216940343, 233503319903854, 284235290001249, 506599554488385, 84489554176900, 228279305185306, 252807799316626, 153512791143146, 454545462509962, 118339653188749, 203182321344334, 74688282504260, 337957830519784, 474967112851298, 65712544211756, 212840449509255, 49784934853197, 192985971123516, 261016646739598, 98026199951513, 158809413718136, 233622810164858, 123595189162535, 268644343436274, 212955473309574, 528875104593113, 147679598953247, 159063707128759, 452960567141219, 475034590922899, 525324910059767, 290088104423329, 314512021341744, 162750803240359, 497283471004344, 54152074062549, 3366826382551, 395279356928351, 428872590463599, 520224392198646, 397562666551233],
    1024: [119049022741239, 3017354369550, 236471541310731, 8369578188092, 201896813751569, 42596045675738, 90047246807738, 77868843294527, 80245678121804, 150572694781271, 121212390004843, 13891477196095, 129502843357245, 249842761979992, 119629919349033, 141060092150412, 52450862291888, 9083892041798, 237871621988368, 179249357669217, 142686812466683, 39533441246680, 257881761041450, 17873492314945, 213001028598374, 169215046048900, 214749208672729, 252694474879322, 163162835151108, 11952997839937, 264893597749487, 21655140300132, 217521381663336, 259261641143525, 111003950739125, 35608642503449, 177879972264272, 119371797570498, 122916450693417, 153048336502542, 168266210355064, 170373348018230, 82171144095346, 21450896537345, 232447750810155, 24010324965642, 118042140796742, 261946341292972, 226917457998112, 35761171973460, 70815242822686, 22574024039369, 22719829731606, 250922873022486, 144920381608370, 80686399623747, 60038187388791, 33295887405171, 171542044961495, 90664030793281, 213373970544321, 213039851938457, 98591451555947, 26570163356389, 149265587949566, 241735824005348, 48277365150582, 262588764758560, 109622719184163, 177153244750314, 207177007122781, 36757323902611, 152479776084543, 27754344313179, 220513005992034, 203514667351898, 102236679636498, 198773641019095, 176108647175187, 116031856185327, 82357337640253, 236100918813933, 26769101962235, 221462907277941, 265949431042276, 264732865429270, 85246010287884, 231559283851417, 41788737698268, 86964312083620, 271298059621756, 61707060920905, 268243652270458, 274686321873853, 255937939367073, 86592605446746, 29560154241975, 40952779130908, 271329518392027, 100297978939116, 10380592549690, 161676495560321, 150727496867072, 255265054900622, 154355496351102, 237938153783494, 54710783047121, 248407451473433, 262368445159313, 63792180161233, 80754775322856, 181361042191352, 121363458373480, 113403140859333, 167392451002211, 81405181312511, 228870370372990, 74550316914519, 255466445857874, 13105282090872, 198492789526083, 83219582501121, 40994428804398, 249086029833877, 169580756591067, 95605073026496, 68629590934448, 231620436379146, 2504340972850, 30143882075200, 165076626758230, 213311571406411, 164937577976080, 89636453550650, 209313891902974, 256702918566975, 115671334463180, 46107460129391, 59761252468798, 164928776823245, 271377705531862, 176890525996500, 7980392533805, 23086190333761, 62601332683737, 181874278527390, 266463230214852, 34410491922901, 129376382397872, 70212419277418, 84368280467759, 139014522726011, 177424477593104, 251799084648433, 83074978912580, 222019740755435, 79875427335951, 118070277975841, 133187715678738, 150368132313826, 42574790390835, 10932694455462, 179493950406789, 135676266535683, 44837446299661, 64056618041992, 128200016500319, 43519652227385, 207827476302214, 253440026285822, 25599840918832, 80114024387639, 155728953997368, 215794335839638, 132867510879476, 148522078316072, 100821853355410, 205654223556948, 13840846473029, 219424073083161, 63193914684247, 185101458735434, 89377968309274, 131396600621696, 108909988522187, 158692876667572, 114263112672072, 35079358131363, 208086305425995, 167095808889327, 116018895523403, 104966166128233, 37867757032821, 140547199220591, 118549310808219, 6438715983364, 178770864879719, 35572651799609, 23435803644949, 124888981697115, 183382888626808, 179659145303625, 258488917532673, 172014305539070, 141733066203502, 150135502454381, 259078250419626, 250062577426988, 102294247862088, 133714758416799, 6876012596845, 89109758243703, 193918940949231, 12591937698560, 201211799270688, 71643157251392, 58195559684364, 28904427997943, 54248002491049, 122113041703489, 203987868271897, 273447417029502, 45184794647906, 54419348895119, 46792718077305, 215359194511580, 167041688804291, 156338717816079, 68193053581496, 168519297405916, 264190143159466, 153569340335159, 116045931906252, 188673551212385, 147467451229086, 245856196640964, 263731646230941, 172905260036932, 142579069633828, 168329922234405, 170319813049445, 62095579222711, 189998515679291, 265183645391927, 225144959038152, 125033926840998, 154847104466181, 213746540473609, 54261487480076, 205052295859746, 39749055486519, 54670384179095, 256194013021364, 50210320644892, 4145998806901, 34253819802949, 541844110972350, 349679632338289, 466106965580168, 205686776411449, 373856788225514, 192380783706980, 246740630143975, 324025491193854, 433090266297400, 312559137631832, 59547024336092, 1399861432034, 406434373694990, 332371105946693, 56836187377566, 369467915637533, 200218760187403, 284070598426176, 431484370479434, 359910002592888, 85624207392544, 193238562571721, 324413210850011, 242936634622281, 62783812603513, 545057249654257, 157742650937864, 244569113397114, 532492068109576, 374347424148869, 156816001118935, 378936669554953, 168606901971765, 468059746254731, 266898310963179, 135511698812933, 49706697658607, 173110238113043, 145474232970612, 517621469137290, 514037784100329, 5033263928144, 27776113064179, 260048580236292, 248266167405892, 26287716166520, 168086228196693, 30163586590047, 109079347288539, 293443349742357, 91356171792642, 21569051334656, 250012911942181, 379790890827500, 522886350878592, 412155544633420, 167097904511090, 395180823203098, 5205720788646, 401058898390224, 267230436217957, 210221529188937, 260396674982976, 78139215372219, 376237496535653, 61198395522114, 38328876203018, 21538440450448, 277360974037873, 97523438717351, 85551207112711, 271865823389797, 392442722057636, 495054263224900, 440436965174432, 36877096498981, 298092681517732, 486425068727796, 275059834727808, 267047460571848, 95247116325169, 119842738422679, 439664434824043, 286127618018483, 177630921655540, 303673778953810, 146677837068359, 107621222005486, 220524140274522, 409765678035661, 422828684969863, 321331983791698, 166986572903090, 59796187458698, 466954091997811, 267500463015653, 520958335157198, 296156342229432, 36377233979770, 356765000440028, 382757471748143, 390452430953177, 59121940072666, 97044459356928, 168544193267314, 139142881966574, 393206927265775, 518015615052836, 519874580297234, 391478305417538, 491464507931943, 413571295059777, 121437027222310, 357714154477890, 294562136215318, 316334171920263, 443769981836741, 5963379847400, 124345092826717, 156850071655211, 157900658308909, 272385656720467, 82214339452391, 450458737147036, 276863521464803, 39508642157635, 55688421973496, 281639841123422, 228095428201656, 222587897091071, 487304974105079, 159977939684730, 32743374927330, 515587556426212, 417635092155115, 63579176021152, 433918250426058, 463330825202644, 430521462242938, 404058684769566, 537853436024500, 173456469999004, 134304460123681, 105825073129925, 378885441304036, 188142596087306, 337300100421552, 469168231496389, 16456663411532, 270344392539619, 124266994199917, 357444025350936, 298075945422803, 457871977517196, 188477063428322, 110827711767685, 170505173395343, 93878729735366, 166759998265184, 158592361571124, 417151860668501, 30140671262139, 68868859308835, 328809963431122, 253497636222030, 330783037839020, 446860904673404, 259443282785759, 259322958456605, 395851040527655, 371876413008780, 459296469877275, 192197533907008, 340646941018270, 259097138328803, 6156664487230, 280191900385114, 155522594501897, 142821527376554, 167957558720560, 282128848744253, 82112078524681, 248136058610911, 180740695271563, 125764307396243, 106978510449820, 125673023900903, 399614887484047, 354464111960884, 422629083458692, 7424742867037, 77598099990070, 483748878436091, 146079719531230, 411646864734472, 203949882558736, 184406301137649, 145972924187300, 193708298718394, 160268893020696, 351065590132554, 435570771943655, 515806591825906, 535057841219056, 338404583416458, 62887381029443, 360040960507261, 543324438792843, 260056522505109, 524496597809517, 543658963174803, 496287039180651, 98816443887399, 176911986879419, 534951360176711, 344257356856088, 289593887504035, 133092464662342, 196147790686145, 548278134531636, 511419490460165, 91541498391937, 166330272001183, 392994856737757, 489675823954945, 283231416585857, 176564177251340, 329063780484888, 70637654678186, 310288714161704, 86945655239561, 479226601184203, 7616102386993, 240954894221107, 483366425759136, 244586037183068, 204112260460034, 365511411037415, 513475778210353, 5993271142618, 211379112066410, 390351283255653, 60744814619489, 371109809233021, 469932707010821, 18797809723457, 455667759408748, 478363858489798, 487800842567672, 327459048475148, 42918501796392, 155885740958745, 124111560471628, 173500270726892, 467688810146367, 399185110244290],
}