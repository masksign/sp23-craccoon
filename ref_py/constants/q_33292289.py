"""
q = 2^25 - 2^18 + 1
sqr1 = sqrt(-1) mod q
i2 = 2^(-1) mod q
"""
q = 33292289
sqr1 = 9749184
i2 = 16646145
i2sqr1 = 28417697

"""
Primitive roots of unity
"""
roots_dict = {
    2: [9749184],
    4: [6169874, 5775402],
    8: [13868609, 11401875, 5988544, 4764222],
    16: [5540785, 4709198, 8602537, 12214371, 8843144, 26030697, 23534631, 16416206],
    32: [6079455, 4015356, 16520472, 14798751, 10189294, 3163919, 1496969, 14628767, 9083783, 18898021, 7486841, 10115231, 12956391, 567667, 14815709, 13675570],
    64: [13677859, 4767163, 10099946, 7478717, 5482851, 10252169, 7579353, 5224140, 16330926, 11835981, 10511333, 8684050, 3770452, 15011332, 10951994, 6221725, 13681753, 5345873, 4064585, 7020367, 7788136, 11850041, 25040205, 2592644, 20770497, 9733009, 26497219, 7205458, 22194721, 16945560, 10094582, 33207963],
    128: [6525477, 7372113, 15553575, 7023528, 15523648, 16477533, 5736721, 258927, 8425921, 5772182, 8502254, 3845927, 6918220, 15014065, 2593045, 5972887, 810169, 9036287, 13094567, 3209090, 2593444, 699490, 14135677, 16428564, 1142626, 4633206, 16499640, 6455350, 1875715, 2041507, 7123114, 3047569, 33109881, 21538137, 11453053, 21665100, 9371119, 30650807, 5039573, 29705480, 20871379, 6111659, 3799182, 21040295, 17775876, 5463382, 30766343, 5662232, 25308943, 3642004, 31004592, 24549921, 7107579, 9998348, 30758223, 33265359, 30593041, 8373339, 5195710, 18574548, 2307137, 121949, 29059263, 6124703],
    256: [12567941, 6634139, 10654240, 2243766, 10320662, 12902090, 11557331, 9592852, 7934616, 414294, 6878175, 2414242, 11348675, 9887078, 1615441, 14608093, 16515394, 15521360, 1000103, 8655678, 3777281, 7610868, 11198088, 13102236, 4302602, 6005195, 8436729, 6686195, 3554358, 10891956, 10615991, 12634039, 12686013, 15165355, 14934409, 1850730, 5685159, 7412724, 8567575, 7698145, 5317541, 1441008, 5919004, 1153614, 12516508, 12042107, 15668743, 14692374, 9273908, 1023657, 13995506, 12144683, 1520745, 1053999, 5934971, 8368822, 14974280, 9200370, 10363180, 6417063, 7733329, 3731286, 13219042, 10757029, 14038612, 11906140, 18759851, 14531834, 15308990, 3530065, 25540302, 12523310, 688011, 15199038, 25420620, 5536405, 19057854, 19948133, 11536658, 2956078, 9043246, 28988932, 23994211, 29271684, 3395270, 12716882, 14257666, 24096696, 10940496, 28051133, 32406134, 27555691, 14955696, 11399088, 10686031, 12658280, 9905241, 4092476, 38753, 24060309, 11139628, 6500987, 31690022, 20509039, 4702012, 28172906, 22048148, 12463534, 6245639, 14865685, 20514085, 20069344, 27647072, 10584381, 25888511, 15282275, 24471002, 8765609, 12136257, 4749362, 7510459, 16872219, 4147380, 14129447, 26158343, 3027189, 20882651, 1067718],
    512: [12110094, 10925601, 12669435, 3074612, 15644322, 6936090, 5635047, 5819743, 9914447, 930764, 3176257, 9797259, 16065595, 4987126, 7025920, 107747, 16040479, 9267377, 7519379, 13157658, 15627533, 7221362, 10258867, 13953735, 9637410, 15381158, 3870436, 12494757, 1271, 6481356, 15070350, 16232362, 10615220, 13221800, 11886142, 14716429, 13792188, 16145347, 5983931, 132425, 4582777, 15510899, 15612398, 9696354, 3807572, 15752307, 1845124, 2921375, 1327729, 686087, 13287483, 10911023, 5782740, 553005, 10933205, 2977627, 2757643, 13831119, 14077069, 1483490, 10921608, 2304223, 12682457, 7301479, 3826673, 361100, 11770769, 2094662, 4101306, 14822414, 4570636, 7025841, 897485, 176416, 6395018, 3893324, 10771467, 12139742, 5793266, 13629091, 2336160, 718928, 2949843, 16198157, 330713, 9840013, 6439641, 11390593, 11554675, 2024714, 13011043, 2043145, 14846756, 3099630, 3930327, 12583070, 8554147, 935741, 9754090, 11522590, 8074798, 11233744, 7315379, 1358913, 11018611, 1638441, 11874188, 4017607, 2649695, 11464266, 13174772, 5898113, 10815252, 6431624, 1378417, 8506878, 12325835, 14129879, 5562448, 14417622, 5197567, 7947213, 13177795, 2209354, 1205455, 8710569, 3619097, 8100070, 6095133, 32084886, 1308511, 8498293, 5634821, 204767, 22485903, 30240813, 25166328, 9631351, 16823551, 905457, 10488270, 31287025, 16396857, 20682889, 31701237, 15287555, 26032908, 6491697, 7746400, 18262775, 31550222, 29879421, 21194513, 16087690, 24429822, 8449678, 14485158, 28438770, 19038331, 14647175, 27640561, 873718, 27025484, 24047926, 25352377, 5076069, 15962774, 18331437, 14739438, 16937521, 27314439, 24381059, 17557772, 14642387, 6242850, 27752541, 22153971, 13983366, 4356233, 9093554, 11742758, 18943984, 7895088, 7914271, 16063617, 2663495, 11515949, 18925251, 25646673, 11827776, 10852840, 22757496, 14959468, 7835904, 11203563, 10946920, 523732, 12144664, 25215458, 22412861, 7941169, 1914133, 16532571, 14001462, 23086489, 21562286, 31625527, 2668776, 28059815, 24357346, 6183531, 2966775, 31909611, 32289059, 445273, 33032345, 32223163, 10454647, 21817600, 5029109, 145583, 1410376, 30482967, 3590671, 16329844, 6797456, 18649418, 26457754, 16923704, 18613472, 27268358, 14911368, 5916148, 10162286, 9547516, 10980271, 24623625, 24620543, 2965501, 24672139, 14542087, 32892753, 25755171, 7468252, 11310268, 8422583, 9041552, 26846580, 24687501, 18009104, 23081230, 22395882, 30625658, 6108950, 5610994, 13711582],
    1024: [326569, 6380337, 7500690, 6959737, 1327519, 16107191, 8069250, 10561752, 12709515, 7375885, 14609423, 14098858, 10466056, 28167, 9624080, 1092378, 6626719, 15525631, 16331152, 5811471, 10979371, 5351180, 10180864, 16204340, 7406721, 9177669, 7996460, 4767212, 302315, 8491921, 9851314, 11674796, 15691576, 3818356, 5016176, 13519371, 16278518, 10311770, 8384667, 5534491, 12335412, 2805598, 6341742, 632771, 5958873, 3896435, 15349155, 11457923, 80426, 12118144, 1534876, 3281221, 4905219, 6364471, 5189067, 4390534, 3566000, 15813406, 4470563, 7464554, 12709236, 2569477, 8878684, 5886145, 10786876, 10784259, 16510012, 16310105, 12643936, 3995465, 1630594, 7185337, 9869660, 9264337, 5338874, 971881, 5831716, 1420249, 11956433, 6132197, 10142548, 5952776, 8893131, 7327366, 15267855, 2699389, 10365021, 10121036, 12614721, 10873630, 4136559, 6785670, 15041681, 5642421, 12448012, 8667605, 5735223, 10778312, 12371812, 4983551, 14489082, 7811474, 4882597, 11553641, 8931938, 4316074, 6300378, 3616910, 2185518, 14550399, 5128938, 6330510, 13354981, 15873765, 1598238, 7344566, 14639068, 14994560, 2259478, 9296921, 14812258, 5546524, 1873395, 10601142, 6500258, 6255082, 16162381, 13837377, 15039700, 2036537, 971958, 12917936, 6212664, 9426788, 10805874, 790334, 2830864, 5572045, 7197644, 571474, 14391192, 16346101, 8187537, 12859674, 4623611, 6768984, 204162, 113654, 355786, 535419, 5576540, 7098892, 6867142, 2224445, 2576547, 1016586, 8731955, 12351528, 15203154, 9745088, 5398710, 5657847, 6270085, 7481717, 4051399, 4192028, 4624707, 5049879, 4424308, 3013139, 7458574, 9792844, 10721301, 1699392, 5281517, 5688763, 14192013, 9725534, 3192815, 16174341, 671459, 14430253, 8432416, 6755780, 1285034, 11392400, 5824944, 4285210, 1644760, 3340435, 5457694, 6180994, 6594202, 12726388, 12270815, 13905722, 10524977, 6487891, 13067751, 7018283, 5100758, 2294218, 165763, 12987043, 2837959, 5344017, 3093639, 5759095, 11986143, 11474537, 1806943, 4567630, 9203985, 1740389, 14176207, 4677943, 15277349, 8888865, 7523848, 9631626, 14642430, 2149672, 9756515, 7276580, 9697215, 13289295, 9921949, 5711329, 7089786, 8888719, 14866974, 11541427, 4174290, 6825327, 4846362, 8757302, 735689, 9854772, 4630642, 4458637, 11475939, 6531335, 10399422, 5280434, 7894347, 7632902, 8110943, 3389641, 8838122, 5293479, 3272533, 6862252, 683370, 13456845, 4854975, 2188368, 2113945, 19811680, 12599444, 543388, 14743345, 12671496, 26461541, 13654178, 138979, 2265414, 15799057, 26569127, 23526583, 25368424, 11661444, 8106092, 19521935, 8932937, 6443691, 10931039, 29767222, 28798454, 32673638, 11478677, 28478983, 24866203, 17877676, 4032797, 27037878, 22914078, 31196530, 29551599, 7189171, 26053792, 7514548, 2876627, 14296812, 21243650, 22385973, 652637, 7013335, 21788867, 26311937, 31912132, 12745732, 19196091, 11092313, 21816411, 24705738, 30328533, 18155741, 21692529, 30322858, 19540620, 657426, 31145607, 21691252, 19763859, 20556241, 19929946, 11546824, 3895887, 626629, 13610764, 17572182, 6924247, 11932962, 32355459, 31336236, 2405315, 13433486, 20676623, 23577794, 6372115, 3591393, 16245098, 30775967, 2814182, 12175125, 30092613, 29220736, 23064919, 27301229, 12234271, 32205855, 3101373, 8454811, 4611362, 20871325, 12332347, 3548876, 33281402, 26276721, 18559733, 1301348, 10976666, 7173951, 6086904, 24103927, 2460932, 31786254, 13738371, 31424044, 14126930, 27694110, 3543925, 5684814, 8360015, 29515797, 27268838, 15449503, 27546445, 15168320, 21309721, 13681114, 1275340, 30717319, 27734525, 6318465, 21145374, 11285078, 6848410, 13968102, 16125572, 32810876, 3475217, 14671769, 19404249, 17631078, 30535561, 25794658, 177351, 16955555, 14533391, 6408446, 10655728, 8558411, 10612644, 1542858, 17188516, 7281332, 28304884, 30514027, 13415033, 9325563, 17332526, 8333264, 16236633, 8977575, 1043938, 6647849, 27952043, 18395837, 29158166, 2376004, 24632605, 32864108, 4886539, 530869, 13102466, 30677116, 1883719, 13572907, 29208494, 3221704, 7585977, 13674956, 8202665, 31474637, 3960782, 9804753, 20279087, 24663596, 7062665, 8758734, 16208759, 10497979, 6855093, 5918102, 3446058, 17949730, 3626761, 21222878, 25939416, 9732931, 15484202, 22816148, 24929233, 9629879, 26988617, 10083182, 22339697, 12516149, 25516893, 23939774, 70146, 18027186, 6529955, 23597111, 3119430, 9250376, 32903021, 28783772, 17494144, 21081538, 10822277, 27980839, 9722824, 19382100, 15561731, 9923147, 11782336, 30774315, 22662199, 31300551, 26097964, 23428589, 13935617, 30784321, 18733865, 7033400, 19616626, 24771660, 8397036, 30932822, 29652154, 3620144, 28055284, 505349, 19002449, 25110113, 16914309, 10902196, 17807380, 9665082, 29913012, 4299417, 16732497, 31380304, 7543718, 3160945, 6678791, 32013682, 9474730, 10895846, 854231, 4634696, 9703530, 783586, 24416983, 20556451, 29861354, 12168783, 2344579, 24396523, 19874634],
}
